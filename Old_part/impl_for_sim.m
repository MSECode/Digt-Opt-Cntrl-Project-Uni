%% SS system in numeric form

A = [0                  1                0              0;
     0                  -0.7737853734e3 -0.6573516819e1 0.1624949284e2;
     0                  0                0              1;
     0                  0.3313238430e4   0.6307193805e2 -0.6957800702e2;];
 
B = [0              0;
     0.3659795684e2 0.1456681540e3;
     0              0;
    -0.1567072230e3 -0.4874973668e3;];

C_sim = eye(4);

D_sim = zeros(4,2);

s1 = tf('s');

TF = (-0.1567072230e3 * s1 / (s1 + 0.843400171542131261e3) / (s1 + 0.564222967725124569e1) / (s1 - 0.567902075180506838e1));
K_p = -200;
K_i = -500;
K_d = -0.0868;

bode(TF)
C_s = pid(K_p, K_i, K_d);
closed_loop_tf = (C_s*TF)/(1 + C_s*TF);
cg_corr = (0.7361478508e4 * s1 + 0.4124314719e5 + 0.8618897265e1 * s1 ^ 2) / (s1 + 0.843348184496169097e3) / (s1 + 0.565014434198424365e1) / (s1 + 0.298394886184661479e1);
